import{B as A}from"./BreadCrumb.9367f10a.js";import{_ as j}from"./select-box.029c2d7e.js";import{b9 as G,b1 as y,r as s,o as L,a as K,c as a,f as n,w as u,t as q}from"./vendor.7710df40.js";import{bw as z,bl as B}from"./index.3bbb47f2.js";import{_ as J}from"./button.996b9c36.js";import{D as W,a as H,b as Q,c as X,d as Y}from"./validator.a755279e.js";import{_ as Z,D as $}from"./toolbar.58f20e48.js";import{n as f}from"./notify.250f5449.js";import{D as ee,a as oe,b as te}from"./popup.1b1ca625.js";import{_ as ne,c as D,p as S}from"./index.7b655b97.js";import{g as w}from"./notifySetting.1837b01c.js";import{p as E}from"./personsRepository.d2cb1535.js";import"./toast.a475c820.js";var d={},ae=G(z);/*!
 * devextreme-vue
 * Version: 21.2.6
 * Build date: Tue Mar 01 2022
 *
 * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file in the root of the project for details.
 *
 * https://github.com/DevExpress/devextreme-vue
 */var le=y&&y.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(d,"__esModule",{value:!0});var se=d.DxOptions=O=d.DxButton=M=d.DxTextBox=void 0,ie=le(ae),re=B,I=B,T=re.createComponent({props:{accessKey:String,activeStateEnabled:Boolean,buttons:Array,disabled:Boolean,elementAttr:Object,focusStateEnabled:Boolean,height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,inputAttr:{},isValid:Boolean,label:String,labelMode:String,mask:String,maskChar:String,maskInvalidMessage:String,maskRules:{},maxLength:[Number,String],mode:String,name:String,onChange:Function,onContentReady:Function,onCopy:Function,onCut:Function,onDisposing:Function,onEnterKey:Function,onFocusIn:Function,onFocusOut:Function,onInitialized:Function,onInput:Function,onKeyDown:Function,onKeyUp:Function,onOptionChanged:Function,onPaste:Function,onValueChanged:Function,placeholder:String,readOnly:Boolean,rtlEnabled:Boolean,showClearButton:Boolean,showMaskMode:String,spellcheck:Boolean,stylingMode:String,tabIndex:Number,text:String,useMaskedValue:Boolean,validationError:{},validationErrors:Array,validationMessageMode:String,validationStatus:String,value:String,valueChangeEvent:String,visible:Boolean,width:[Function,Number,String]},emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:buttons":null,"update:disabled":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:inputAttr":null,"update:isValid":null,"update:label":null,"update:labelMode":null,"update:mask":null,"update:maskChar":null,"update:maskInvalidMessage":null,"update:maskRules":null,"update:maxLength":null,"update:mode":null,"update:name":null,"update:onChange":null,"update:onContentReady":null,"update:onCopy":null,"update:onCut":null,"update:onDisposing":null,"update:onEnterKey":null,"update:onFocusIn":null,"update:onFocusOut":null,"update:onInitialized":null,"update:onInput":null,"update:onKeyDown":null,"update:onKeyUp":null,"update:onOptionChanged":null,"update:onPaste":null,"update:onValueChanged":null,"update:placeholder":null,"update:readOnly":null,"update:rtlEnabled":null,"update:showClearButton":null,"update:showMaskMode":null,"update:spellcheck":null,"update:stylingMode":null,"update:tabIndex":null,"update:text":null,"update:useMaskedValue":null,"update:validationError":null,"update:validationErrors":null,"update:validationMessageMode":null,"update:validationStatus":null,"update:value":null,"update:valueChangeEvent":null,"update:visible":null,"update:width":null},model:{prop:"value",event:"update:value"},computed:{instance:function(){return this.$_instance}},beforeCreate:function(){this.$_WidgetClass=ie.default,this.$_hasAsyncTemplate=!0,this.$_expectedChildren={button:{isCollectionItem:!0,optionName:"buttons"}}}}),M=d.DxTextBox=T,p=I.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:location":null,"update:name":null,"update:options":null},props:{location:String,name:String,options:Object}}),O=d.DxButton=p;p.$_optionName="buttons";p.$_isCollectionItem=!0;p.$_expectedChildren={options:{isCollectionItem:!1,optionName:"options"}};var F=I.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:bindingOptions":null,"update:disabled":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:icon":null,"update:onClick":null,"update:onContentReady":null,"update:onDisposing":null,"update:onFocusIn":null,"update:onFocusOut":null,"update:onInitialized":null,"update:onOptionChanged":null,"update:rtlEnabled":null,"update:stylingMode":null,"update:tabIndex":null,"update:template":null,"update:text":null,"update:type":null,"update:useSubmitBehavior":null,"update:validationGroup":null,"update:visible":null,"update:width":null},props:{accessKey:String,activeStateEnabled:Boolean,bindingOptions:Object,disabled:Boolean,elementAttr:Object,focusStateEnabled:Boolean,height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,icon:String,onClick:Function,onContentReady:Function,onDisposing:Function,onFocusIn:Function,onFocusOut:Function,onInitialized:Function,onOptionChanged:Function,rtlEnabled:Boolean,stylingMode:String,tabIndex:Number,template:{},text:String,type:String,useSubmitBehavior:Boolean,validationGroup:String,visible:Boolean,width:[Function,Number,String]}});se=d.DxOptions=F;F.$_optionName="options";var Le=d.default=T;const ue=await E.GetPersonTypes(),de=await E.GetPersonLookUp(),x="https://kameyo-api.azurewebsites.net",C=`${x}/api/users`,pe=`${x}/api/roles`,Ke=`${x}/api/Files/Images/profiles/users/2863ae38-9aba-4551-a4b2-7cd8b6e4d2cf`,ce=async e=>{const t="test@dx-email.com";return new Promise(l=>{setTimeout(()=>{l(e===t)},1e3)})},me={name:"UserView",components:{BreadCrumb:A,DxToolbar:Z,DxItemToolbar:$,DxRequiredRule:W,DxCompareRule:H,DxAsyncRule:Q,DxEmailRule:X,DxTextBox:M,DxSelectBox:j,DxButton:J,DxValidator:Y,DxTextBoxButton:O,DxPopup:ee,DxPosition:oe,DxToolbarItem:te},data(){return{stylingMode:"filled",labelMode:"floating",passwordMode:"password",confirmPasswordMode:"password",popupVisible:!1,popupMessageSave:"",personTypeEmployee:"f35d8016-c93b-4a05-9301-4c228d639a02",personTypeContact:"f11d7e55-f12e-4214-b100-0989b38f66bc",personTypeDS:ue,personDS:de,rolesDS:[],formData:{id:"",email:"",password:"",personTypeId:"",personId:""},backButtonOptions:{type:"back",onClick:()=>{this.$router.push({name:"usersView"})}},addButtonOptions:{icon:"user",text:"Nuevo",onClick:()=>{this.formData={id:"",email:"",password:"",personTypeId:"",personId:""}}},saveButtonOptions:{icon:"check",text:"Grabar",type:"success",onClick:async e=>{const t=await e.validationGroup.validate();console.log("validationGroup - ",e.validationGroup),console.log("validationGroup - ",t),t.isValid?await this.createUser():f("Los datos no se guardaron. Por favor, compruebe si todos los campos son v\xE1lidos.","error")}},buttonOptions:{icon:"check",text:"Grabar",type:"success",useSubmitBehavior:!0},passwordButton:{icon:"/assets/icons/eye.png",type:"default",onClick:()=>{this.passwordMode=this.passwordMode==="text"?"password":"text"}},confirmPasswordButton:{icon:"/assets/icons/eye.png",type:"default",onClick:()=>{this.confirmPasswordMode=this.confirmPasswordMode==="text"?"password":"text"}},popupCloseButtonOptions:{text:"Close",onClick:()=>{this.popupVisible=!1}}}},methods:{async ValidationEmail(e){return console.log("asyncValidationEmail - ",e.value),await ce(e.value)},passwordComparison(){return console.log("passwordComparison - ",this.formData.password),this.formData.password},handleSubmit(e){e.preventDefault()},fieldDataChanged:function(e){if(e.dataField==="personTypeId"){var t=e.component.getEditor("personId");let l=t.getDataSource(),r=this.personTypeContact==e.value?e.value:this.personTypeEmployee;l.filter([["personTypeId","=",e.value],"or",["personTypeId","=",r]]),l.load(),t.reset()}},isEmptyOrSpaces(e){return e===null||e.match(/^ *$/)!==null},async createUser(){const e="POST";var t={email:this.formData.email,password:this.formData.password,personTypeId:this.isEmptyOrSpaces(this.formData.personTypeId)?null:this.formData.personTypeId,personId:this.isEmptyOrSpaces(this.formData.personId)?null:this.formData.personId};return console.log("createUser - ",JSON.stringify(t)),fetch(`${C}`,{method:e,body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(l=>{if(console.log("createUser - ",l),l.ok)this.popupVisible=!0,this.popupMessageSave="Los datos se guard\xF3 con \xE9xito.",this.clearFormData();else return l.json()}).then(l=>{let r=`Los datos NO se guardaron.
`;l.hasOwnProperty("succeeded")&&l.errors.forEach(o=>{r=r+`
* `+o.message,console.log("errors - ",r)}),this.popupVisible=!0,this.popupMessageSave=r,console.log("errors - ",r)})},clearFormData(){this.formData={id:"",email:"",password:"",personTypeId:"",personId:""}},updateUser(){var e={id:this.$route.params.id,email:this.formData.email,personTypeId:this.formData.personTypeId,personId:this.formData.personId};fetch(`${C}/${e.id}`,{method:"PUT",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(D).then(S).then(t=>{if(console.log("data",t),t.succeeded)return f(w("El registro se actualizo correctamente.")),t;f(w("El registro no se actualizo correctamente.","error"))})},async loadRoles(){return await this.loadDataFetch(`${pe}`).then(t=>t.data.data)},async loadDataFetch(e){return await fetch(`${e}`).then(D).then(S).then(t=>t)}},async mounted(){this.rolesDS=await this.loadRoles()}},he={id:"main-content"},be={class:"container-fluid"},ge={class:"block-header"},fe={class:"row clearfix"},xe={class:"col-md-12"},ve={class:"card"},_e={class:"header"},ye={class:"body"},De={id:"formUserCreateView"},Se={class:"editors"},we={class:"center"},Ce={class:"editors-container"},Be={class:"left"},Ee={class:"right"};function Ie(e,t,l,r,o,c){const k=s("bread-crumb"),m=s("DxItemToolbar"),R=s("DxToolbar"),P=s("DxToolbarItem"),V=s("DxPopup"),h=s("DxRequiredRule"),N=s("DxEmailRule"),b=s("DxValidator"),g=s("DxTextBox"),v=s("DxTextBoxButton"),U=s("DxCompareRule"),_=s("DxSelectBox");return L(),K("div",he,[a("div",be,[a("div",ge,[n(k)]),a("div",fe,[a("div",xe,[a("div",ve,[a("div",_e,[n(R,null,{default:u(()=>[n(m,{options:o.backButtonOptions,location:"before",widget:"dxButton"},null,8,["options"]),n(m,{options:o.addButtonOptions,location:"after","locate-in-menu":"auto",widget:"dxButton"},null,8,["options"]),n(m,{options:o.saveButtonOptions,location:"after","locate-in-menu":"auto",widget:"dxButton"},null,8,["options"])]),_:1})]),a("div",ye,[a("form",{ref:"formCreateUser",action:"your-action",onSubmit:t[4]||(t[4]=(...i)=>c.handleSubmit&&c.handleSubmit(...i))},[a("div",De,[n(V,{visible:o.popupVisible,"onUpdate:visible":t[0]||(t[0]=i=>o.popupVisible=i),"drag-enabled":!1,"hide-on-outside-click":!0,"show-close-button":!1,"show-title":!0,width:300,height:280,container:".dx-viewport",title:"Informacion"},{default:u(()=>[n(P,{widget:"dxButton",toolbar:"bottom",location:"after",options:o.popupCloseButtonOptions},null,8,["options"]),a("p",null,[a("span",null,q(o.popupMessageSave),1)])]),_:1},8,["visible"]),a("div",Se,[a("div",we,[n(g,{"styling-mode":o.stylingMode,"label-mode":o.labelMode,value:o.formData.email,"onUpdate:value":t[1]||(t[1]=i=>o.formData.email=i),width:"100%",placeholder:"Email",label:"Email"},{default:u(()=>[n(b,null,{default:u(()=>[n(h,{message:"Correo electronico es requerido"}),n(N,{message:"Correo electronico no es valido"})]),_:1})]),_:1},8,["styling-mode","label-mode","value"])]),a("div",Ce,[a("div",Be,[n(g,{"styling-mode":o.stylingMode,"label-mode":o.labelMode,value:o.formData.password,"onUpdate:value":t[2]||(t[2]=i=>o.formData.password=i),mode:o.passwordMode,width:"100%",placeholder:"Contrase\xF1a",label:"Contrase\xF1a"},{default:u(()=>[n(v,{options:o.passwordButton,name:"password",location:"after"},null,8,["options"]),n(b,null,{default:u(()=>[n(h,{message:"Contrase\xF1a es requerida."})]),_:1})]),_:1},8,["styling-mode","label-mode","value","mode"]),n(g,{"styling-mode":o.stylingMode,"label-mode":o.labelMode,mode:o.confirmPasswordMode,"onUpdate:mode":t[3]||(t[3]=i=>o.confirmPasswordMode=i),width:"100%",placeholder:"Confirmar contrase\xF1a",label:"Confirmar contrase\xF1a"},{default:u(()=>[n(v,{options:o.confirmPasswordButton,name:"confirmPassword",location:"after"},null,8,["options"]),n(b,null,{default:u(()=>[n(h,{message:"Confirmacion de la contrase\xF1a es requerida"}),n(U,{message:"Contrase\xF1a y Confirmacion de la contrase\xF1a no son iguales","comparison-target":c.passwordComparison},null,8,["comparison-target"])]),_:1})]),_:1},8,["styling-mode","label-mode","mode"])]),a("div",Ee,[n(_,{items:o.personTypeDS,"styling-mode":o.stylingMode,"label-mode":o.labelMode,value:o.formData.personTypeId,displayExpr:"name",valueExpr:"id",showClearButton:"true",width:"100%",placeholder:"Tipo de usuario",label:"Tipo de usuario"},null,8,["items","styling-mode","label-mode","value"]),n(_,{items:o.personDS,"styling-mode":o.stylingMode,"label-mode":o.labelMode,value:o.formData.personId,displayExpr:"fullName",valueExpr:"id",searchEnabled:"true",showClearButton:"true",width:"100%",placeholder:"Persona",label:"Persona"},null,8,["items","styling-mode","label-mode","value"])])])])])],544)])])])])])])}var qe=ne(me,[["render",Ie]]);export{qe as default};
