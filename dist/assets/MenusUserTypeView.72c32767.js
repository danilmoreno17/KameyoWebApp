import{D as y,a as w,b as U,e as T,B as M,C as v,v as I}from"./data-grid.24b081de.js";import{C as b}from"./index.3bbb47f2.js";import{B as C}from"./BreadCrumb.9367f10a.js";import{_ as G}from"./select-box.029c2d7e.js";import{_ as R,c as E,p as N}from"./index.7b655b97.js";import{r as o,o as B,a as V,c as l,f as t,w as r}from"./vendor.7710df40.js";const u="https://kameyo-api.azurewebsites.net",c=`${u}/api/menu/role`,k=`${u}/api/roles`,$={name:"MenuUserTypeView",components:{BreadCrumb:C,DxSelectBox:G,DxDataGrid:y,DxColumn:w,DxScrolling:U,DxEditing:T,DxToolbar:M,DxItem:v,DxGrouping:I},data(){return{selectedRowIndex:-1,catalogMenuIdSelected:"",dataGridRefName:"dataGridMenusUserType",rolesDS:[],rolSelected:"",menuUserTypeDS:new b({key:"id",load:this.loadMenuUserType,update:(e,a)=>this.updateUserRoles({key:e,values:a}),errorHandler:e=>{console.log(e.message)}})}},methods:{rowUpdating(e){this.catalogMenuIdSelected=e.oldData.catalogMenuId},async loadMenuUserType(){return await this.loadDataFetch(`${c}?roleId=${this.rolSelected}`).then(e=>e)},async loadDataFetch(e){return await fetch(`${e}`).then(E).then(N).then(a=>a)},async loadRoles(){return await this.loadDataFetch(`${k}`).then(a=>a.data.data)},async updateUserRoles(e={}){var a={id:e.key,userId:null,roleId:this.rolSelected,catalogMenuId:this.catalogMenuIdSelected,menuRolSelected:e.values.menuSelected};const d={method:"PUT",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json"}},s=await(await fetch(`${c}`,d)).json()},onValueChanged({value:e}){this.rolSelected=e,this.$refs[this.dataGridRefName].instance.getDataSource().reload()}},async mounted(){this.rolesDS=await this.loadRoles(),this.rolSelected=this.rolesDS[0].id}},O={id:"main-content"},A={class:"container-fluid"},j={class:"block-header"},F={class:"row clearfix"},L={class:"col-md-12"};function J(e,a,d,p,s,i){const m=o("bread-crumb"),_=o("DxGrouping"),D=o("DxEditing"),n=o("DxColumn"),h=o("DxScrolling"),x=o("DxItem"),f=o("DxToolbar"),g=o("DxSelectBox"),S=o("DxDataGrid");return B(),V("div",O,[l("div",A,[l("div",j,[t(m)]),l("div",F,[l("div",L,[t(S,{id:"dataGridMenusUserType",ref:s.dataGridRefName,"key-expr":"id","show-borders":!0,"data-source":s.menuUserTypeDS,"repaint-changes-only":!0,selection:{mode:"single"},onRowUpdating:i.rowUpdating},{personTypeTemplate:r(()=>[t(g,{width:"225",items:s.rolesDS,"display-expr":"name","value-expr":"id",value:s.rolSelected,onValueChanged:i.onValueChanged},null,8,["items","value","onValueChanged"])]),default:r(()=>[t(_,{"auto-expand-all":e.autoExpandAll},null,8,["auto-expand-all"]),t(D,{"refresh-mode":e.refreshMode,"allow-updating":!0,mode:"cell"},null,8,["refresh-mode"]),t(n,{"data-field":"userId",caption:"UserId",visible:!1}),t(n,{"data-field":"UserTypeId",caption:"UserTypeId",visible:!1}),t(n,{"data-field":"catalogMenuId",caption:"catalogMenuId",visible:!1}),t(n,{"group-index":0,"data-field":"menuName",caption:"Menu","data-type":"string","allow-editing":!1}),t(n,{"data-field":"subMenuName",caption:"Menu","data-type":"string","allow-editing":!1}),t(n,{"data-field":"menuSelected",caption:"Menu Seleccionado","data-type":"boolean"}),t(h,{mode:"virtual"}),t(f,null,{default:r(()=>[t(x,{location:"after",template:"personTypeTemplate"})]),_:1})]),_:1},8,["data-source","onRowUpdating"])])])])])}var Q=R($,[["render",J]]);export{Q as default};
