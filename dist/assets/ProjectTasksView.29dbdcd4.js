import{D as C,a as b,b as E,c as v,d as F,e as I,f as G,g as N,h as q,i as L,j as A}from"./data-grid.24b081de.js";import{B}from"./BreadCrumb.9367f10a.js";import{D as M}from"./form.181df029.js";import{C as V}from"./index.3bbb47f2.js";import{c as J}from"./CellLinkTemplate.75b044c2.js";import{R as f}from"./RepositoryFactory.1ead146f.js";import{r,o as O,a as U,c as l,f as t,w as s}from"./vendor.7710df40.js";import{_ as $}from"./index.7b655b97.js";const g=f.get("catalogs"),p=f.get("projectTasks"),z=f.get("projects");function H(e){return e!=null&&e!==""}const K={name:"ProjectTasksView",components:{DxDataGrid:C,DxColumn:b,DxScrolling:E,DxPager:v,DxPaging:F,DxEditing:I,DxRequiredRule:G,DxPopup:N,DxLookup:q,DxFilterRow:L,DxForm:A,DxItem:M,cellLink:J,BreadCrumb:B},data(){return{dataSource:new V({key:"id",load:e=>{let a={};return["skip","take","requireTotalCount","requireGroupCount","sort","filter","totalSummary","group","groupSummary"].forEach(d=>{d in e&&H(e[d])&&(a[d]=JSON.stringify(e[d]))}),this.getProjectTasks(a)},insert:e=>this.createProjectTask(e),update:(e,a)=>(a.id=e,this.updateProjectTask(a)),remove:e=>this.deleteProjectTask(e)}),projectTaskType:{},projectTaskState:{},project:{}}},methods:{sendRequest(e,a="GET",d={}){const u=Object.keys(d).map(o=>`${encodeURIComponent(o)}=${encodeURIComponent(d[o])}`).join("&");return a==="GET"?(console.log("params",u),fetch(`${e}?${u}`,{method:a}).then(o=>o.json().then(c=>{if(o.ok)return c.data;throw c.Message}))):fetch(e,{method:a,body:d.values,headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(o=>o.ok?o.text().then(c=>c&&JSON.parse(c)):o.json().then(c=>{throw c.Message}))},getProjectTasks:async function(e){const{data:a}=await p.GetWithFilter(e);return a.data},createProjectTask:async function(e){const{data:a}=await p.Create(e);return a},updateProjectTask:async function(e){const{data:a}=await p.Update(e);return a},deleteProjectTask:async function(e){const{data:a}=await p.Delete(e);return a},getProjects:async function(){const{data:e}=await z.GetWithPagination({});this.project=e.data},getProjectTaskTypes:async function(){const{data:e}=await g.Get("NAME","PROJECTTASKTYPE");this.projectTaskType=e.data},getProjectTaskStates:async function(){const{data:e}=await g.Get("NAME","PROJECTTASKSTATE");this.projectTaskState=e.data}},async created(){await this.getProjects(),await this.getProjectTaskTypes(),await this.getProjectTaskStates()}},W={id:"main-content"},Y={class:"container-fluid"},Q={class:"block-header"},X={class:"row clearfix"},Z={class:"col-md-12"};function tt(e,a,d,u,o,c){const h=r("bread-crumb"),x=r("DxFilterRow"),T=r("DxScrolling"),k=r("DxPaging"),w=r("DxPager"),y=r("DxPopup"),n=r("DxItem"),j=r("DxForm"),P=r("DxEditing"),_=r("DxRequiredRule"),i=r("DxColumn"),m=r("DxLookup"),R=r("cellLink"),S=r("DxDataGrid");return O(),U("div",W,[l("div",Y,[l("div",Q,[t(h)]),l("div",X,[l("div",Z,[t(S,{id:"dataGridProjectTask","data-source":o.dataSource,"show-borders":!0,"repaint-changes-only":!0,"remote-operations":!0,"key-expr":"id"},{"cell-link-template":s(({data:D})=>[t(R,{"cell-data":D,routePath:{name:"projectTaskView",params:{id:D.data.id}}},null,8,["cell-data","routePath"])]),default:s(()=>[t(x,{visible:!0}),t(T,{"row-rendering-mode":"virtual"}),t(k,{"page-size":10}),t(w,{visible:!0,"allowed-page-sizes":[10,20,50],"display-mode":e.displayMode,"show-page-size-selector":!0,"show-info":!1,"show-navigation-buttons":!0},null,8,["display-mode"]),t(P,{"refresh-mode":e.full,"allow-updating":!0,"allow-adding":!0,"allow-deleting":!0,mode:"popup"},{default:s(()=>[t(y,{"show-title":!0,width:700,height:525,title:"Informaci\xF3n de la Tarea"}),t(j,null,{default:s(()=>[t(n,{"col-count":1,"col-span":2,"item-type":"group"},{default:s(()=>[t(n,{"data-field":"name"}),t(n,{"data-field":"projectId"}),t(n,{"data-field":"description"}),t(n,{"data-field":"order"})]),_:1}),t(n,{"col-count":2,"col-span":2,"item-type":"group",caption:"Tiempos de la tarea"},{default:s(()=>[t(n,{"data-field":"catalogTaskTypeId"}),t(n,{"data-field":"catalogTaskStateId"}),t(n,{"data-field":"startDate"}),t(n,{"data-field":"endDate"}),t(n,{"data-field":"durationHour"}),t(n,{"data-field":"closeDate"}),t(n,{"data-field":"progress"})]),_:1})]),_:1})]),_:1},8,["refresh-mode"]),t(i,{width:150,"data-field":"name",caption:"Nombre","cell-template":"cell-link-template"},{default:s(()=>[t(_)]),_:1}),t(i,{width:150,"data-field":"projectId",caption:"Proyecto"},{default:s(()=>[t(_),t(m,{"data-source":o.project,"value-expr":"id","display-expr":"name"},null,8,["data-source"])]),_:1}),t(i,{width:200,"data-field":"description",caption:"Descripci\xF3n"}),t(i,{width:0,"data-field":"order",caption:"Orden","data-type":"number"}),t(i,{width:0,"data-field":"catalogTaskTypeId",caption:"Tipo de Tarea"},{default:s(()=>[t(m,{"data-source":o.projectTaskType,"value-expr":"id","display-expr":"value"},null,8,["data-source"])]),_:1}),t(i,{width:150,"data-field":"catalogTaskStateId",caption:"Estado de Tarea"},{default:s(()=>[t(m,{"data-source":o.projectTaskState,"value-expr":"id","display-expr":"value"},null,8,["data-source"])]),_:1}),t(i,{width:150,"data-field":"startDate",caption:"Fecha de Inicio","data-type":"date"}),t(i,{width:150,"data-field":"endDate",caption:"Fecha de Fin","data-type":"date"}),t(i,{width:100,"data-field":"durationHour",caption:"Duraci\xF3n","data-type":"number"}),t(i,{width:150,"data-field":"closeDate",caption:"Fecha de Cierre","data-type":"date"}),t(i,{width:100,"data-field":"progress",caption:"Progreso","data-type":"number"})]),_:1},8,["data-source"])])])])])}var ct=$(K,[["render",tt]]);export{ct as default};
